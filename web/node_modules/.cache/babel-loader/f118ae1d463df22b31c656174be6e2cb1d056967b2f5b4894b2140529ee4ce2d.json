{"ast":null,"code":"var _jsxFileName = \"/home/ronald/Documents/STL-S2/CPA/ProjetCPAJeu/web/src/components/canvas/index.tsx\",\n  _s = $RefreshSig$();\nimport * as conf from './conf';\nimport { useRef, useEffect } from 'react';\nimport { step, click, mouseMove, endOfGame, handleKeyPress } from './state';\nimport { render } from './renderer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst randomInt = max => Math.floor(Math.random() * max);\nconst randomSign = () => Math.sign(Math.random() - 0.5);\nconst initCanvas = iterate => canvas => {\n  const ctx = canvas.getContext('2d');\n  if (!ctx) return;\n  requestAnimationFrame(() => iterate(ctx));\n};\nconst Canvas = ({\n  height,\n  width\n}) => {\n  _s();\n  const test = new Array(0);\n  test.push({\n    leftTop: {\n      x: 0,\n      y: 0\n    },\n    rightBottom: {\n      x: width,\n      y: conf.BOUNDTOP - conf.RADIUS * 2\n    }\n  }); // Mur du haut\n  test.push({\n    leftTop: {\n      x: 0,\n      y: 0\n    },\n    rightBottom: {\n      x: conf.BOUNDLEFT - conf.RADIUS * 2,\n      y: height\n    }\n  }); // Mur de gauche\n  test.push({\n    leftTop: {\n      x: width - conf.BOUNDLEFT,\n      y: 0\n    },\n    rightBottom: {\n      x: width,\n      y: height\n    }\n  }); // Mur de droite\n  test.push({\n    leftTop: {\n      x: 0,\n      y: height - conf.BOUNDTOP\n    },\n    rightBottom: {\n      x: width,\n      y: height\n    }\n  }); // Mur du bas\n\n  const listObjectC = new Array(0);\n  listObjectC.push({\n    center: {\n      x: 500,\n      y: 350\n    },\n    radius: 25\n  });\n  const listObjectR = new Array(0);\n  listObjectR.push({\n    leftTop: {\n      x: 1000,\n      y: 400\n    },\n    rightBottom: {\n      x: 1100,\n      y: 500\n    }\n  });\n  const initialState = {\n    hero: {\n      coord: {\n        x: (test[2].leftTop.x - test[1].rightBottom.x) / 2 + test[1].rightBottom.x,\n        y: window.innerHeight - 150,\n        dx: 3,\n        dy: 3\n      },\n      hitBox: {\n        hx: 50,\n        hy: 50\n      },\n      vie: 3,\n      force: 10\n    },\n    pos: new Array(2).fill(1).map(_ => ({\n      life: conf.BALLLIFE,\n      coord: {\n        x: randomInt(width - (120 + 2 * conf.BOUNDLEFT)) + (60 + conf.BOUNDLEFT),\n        y: randomInt(height - (120 + 2 * conf.BOUNDTOP)) + (60 + conf.BOUNDTOP),\n        dx: 4 * randomSign(),\n        dy: 4 * randomSign()\n      }\n    })),\n    limite: test,\n    objectC: listObjectC,\n    objectR: listObjectR,\n    size: {\n      height: height - conf.BOUNDTOP,\n      width: width - conf.BOUNDLEFT\n    },\n    endOfGame: true\n  };\n  const ref = useRef();\n  const state = useRef(initialState);\n  const iterate = ctx => {\n    state.current = step(state.current);\n    state.current.endOfGame = !endOfGame(state.current);\n    render(ctx)(state.current);\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx));\n  };\n  const onClick = e => {\n    state.current = click(state.current)(e);\n  };\n  const onMove = e => {\n    state.current = mouseMove(state.current)(e);\n  };\n  const onKey = e => {\n    state.current = handleKeyPress(state.current)(e);\n  };\n  useEffect(() => {\n    if (ref.current) {\n      initCanvas(iterate)(ref.current);\n      ref.current.addEventListener('click', onClick);\n      ref.current.addEventListener('mousemove', onMove);\n      window.addEventListener(\"keydown\", onKey);\n    }\n    return () => {\n      ref.current.removeEventListener('click', onMove);\n      ref.current.removeEventListener('mousemove', onMove);\n      window.removeEventListener(\"keydown\", onKey);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    height,\n    width,\n    ref\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 10\n  }, this);\n};\n_s(Canvas, \"Gpm0P4FfDB25XYapIJctmdb7SaA=\");\n_c = Canvas;\nexport default Canvas;\nvar _c;\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"names":["conf","useRef","useEffect","step","click","mouseMove","endOfGame","handleKeyPress","render","jsxDEV","_jsxDEV","randomInt","max","Math","floor","random","randomSign","sign","initCanvas","iterate","canvas","ctx","getContext","requestAnimationFrame","Canvas","height","width","_s","test","Array","push","leftTop","x","y","rightBottom","BOUNDTOP","RADIUS","BOUNDLEFT","listObjectC","center","radius","listObjectR","initialState","hero","coord","window","innerHeight","dx","dy","hitBox","hx","hy","vie","force","pos","fill","map","_","life","BALLLIFE","limite","objectC","objectR","size","ref","state","current","onClick","e","onMove","onKey","addEventListener","removeEventListener","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/ronald/Documents/STL-S2/CPA/ProjetCPAJeu/web/src/components/canvas/index.tsx"],"sourcesContent":["import * as conf from './conf'\nimport { useRef, useEffect } from 'react'\nimport { State, step, click, mouseMove, endOfGame, handleKeyPress } from './state'\nimport { render } from './renderer'\n\nconst randomInt = (max: number) => Math.floor(Math.random() * max)\nconst randomSign = () => Math.sign(Math.random() - 0.5)\n\nconst initCanvas =\n  (iterate: (ctx: CanvasRenderingContext2D) => void) =>\n  (canvas: HTMLCanvasElement) => {\n    const ctx = canvas.getContext('2d')\n    if (!ctx) return\n    requestAnimationFrame(() => iterate(ctx))\n  }\n\nconst Canvas = ({ height, width }: { height: number; width: number }) => {\n\n  const test = new Array(0) \n  test.push({leftTop:{x:0,y:0}, rightBottom:{x:width,y:conf.BOUNDTOP-(conf.RADIUS*2)}}) // Mur du haut\n  test.push({leftTop:{x:0,y:0}, rightBottom:{x:conf.BOUNDLEFT-(conf.RADIUS*2),y:height}}) // Mur de gauche\n  test.push({leftTop:{x:width-(conf.BOUNDLEFT),y:0}, rightBottom:{x:width,y:height}}) // Mur de droite\n  test.push({leftTop:{x:0,y:height-conf.BOUNDTOP}, rightBottom:{x:width,y:height}}) // Mur du bas\n  \n  const listObjectC = new Array(0)\n  listObjectC.push({center:{x:500, y:350}, radius : 25})\n \n  const listObjectR = new Array(0)\n  listObjectR.push({leftTop:{x:1000, y:400}, rightBottom : {x:1100, y:500}})\n\n  const initialState: State = {\n    hero : {\n      coord : {\n        x: ((test[2].leftTop.x - test[1].rightBottom.x) /2)+ test[1].rightBottom.x,\n        y: window.innerHeight - 150,\n        dx: 3,\n        dy: 3,\n      },\n      hitBox : {\n        hx: 50, \n        hy: 50,\n      },\n      vie: 3,\n      force: 10,\n    },\n    pos: new Array(2).fill(1).map((_) => ({\n      life: conf.BALLLIFE,\n      coord: {\n        x: randomInt(width - (120+(2*conf.BOUNDLEFT))) + (60+conf.BOUNDLEFT),\n        y: randomInt(height - (120+(2*conf.BOUNDTOP))) + (60+conf.BOUNDTOP),\n        dx: 4 * randomSign(),\n        dy: 4 * randomSign(),\n      },\n    })),\n    limite: test,\n    objectC: listObjectC,\n    objectR: listObjectR,\n    \n    size: { height: height - conf.BOUNDTOP, width: width - conf.BOUNDLEFT  },\n    endOfGame: true,\n  }\n\n  const ref = useRef<any>()\n  const state = useRef<State>(initialState)\n\n  const iterate = (ctx: CanvasRenderingContext2D) => {\n    state.current = step(state.current)\n    state.current.endOfGame = !endOfGame(state.current)\n    render(ctx)(state.current)\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx))\n  } \n\n  const onClick = (e: PointerEvent) => {\n    state.current = click(state.current)(e)\n  }\n\n  const onMove = (e: PointerEvent) => {\n    state.current = mouseMove(state.current)(e)\n  }\n\n  const onKey = (e: KeyboardEvent) => {\n    state.current = handleKeyPress(state.current)(e)\n  }\n\n  useEffect(() => {\n    if (ref.current) {\n      initCanvas(iterate)(ref.current)\n      ref.current.addEventListener('click', onClick)\n      ref.current.addEventListener('mousemove', onMove)\n      window.addEventListener(\"keydown\",onKey)\n    }\n    return () => {\n      ref.current.removeEventListener('click', onMove)\n      ref.current.removeEventListener('mousemove', onMove)\n      window.removeEventListener(\"keydown\",onKey)\n    }\n  }, [])\n  return <canvas {...{ height, width, ref }} />\n}\n\nexport default Canvas\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}