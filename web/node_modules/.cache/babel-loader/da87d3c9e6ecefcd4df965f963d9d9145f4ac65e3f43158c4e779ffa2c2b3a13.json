{"ast":null,"code":"var _jsxFileName = \"D:\\\\varlesse\\\\Documents\\\\GitHub\\\\try\\\\ProjetCPAWEB\\\\web\\\\src\\\\components\\\\canvas\\\\index.tsx\",\n  _s = $RefreshSig$();\nimport * as conf from './conf';\nimport { useRef, useEffect } from 'react';\nimport { step, click, mouseMove, handleKeyPress } from './state';\nimport { render } from './renderer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst randomInt = max => Math.floor(Math.random() * max);\nconst randomSign = () => Math.sign(Math.random() - 0.5);\nconst initCanvas = iterate => canvas => {\n  const ctx = canvas.getContext('2d');\n  if (!ctx) return;\n  requestAnimationFrame(() => iterate(ctx));\n};\nconst Canvas = ({\n  height,\n  width\n}) => {\n  _s();\n  const test = new Array(0);\n  test.push({\n    leftTop: {\n      x: 0,\n      y: 0\n    },\n    rightBottom: {\n      x: width,\n      y: conf.BOUNDTOP - conf.RADIUS * 2\n    }\n  }); // Mur du haut\n  test.push({\n    leftTop: {\n      x: 0,\n      y: 0\n    },\n    rightBottom: {\n      x: conf.BOUNDLEFT - conf.RADIUS * 2,\n      y: height\n    }\n  }); // Mur de gauche\n  test.push({\n    leftTop: {\n      x: width - conf.BOUNDLEFT,\n      y: 0\n    },\n    rightBottom: {\n      x: width,\n      y: height\n    }\n  }); // Mur de droite\n  test.push({\n    leftTop: {\n      x: 0,\n      y: height - conf.BOUNDTOP\n    },\n    rightBottom: {\n      x: width,\n      y: height\n    }\n  }); // Mur du bas\n\n  const tirs = new Array(0);\n  const debris = new Array(0);\n  const ennemisQuiTire = new Array(0);\n  const listObjectC = new Array(0);\n  listObjectC.push({\n    coord: {\n      x: 500,\n      y: 350,\n      dx: 0,\n      dy: 0\n    },\n    radius: 25\n  });\n  const listObjectR = new Array(0);\n  listObjectR.push({\n    leftTop: {\n      x: 1000,\n      y: 400\n    },\n    rightBottom: {\n      x: 1100,\n      y: 500\n    }\n  });\n  const initialState = {\n    hero: {\n      coord: {\n        x: (test[2].leftTop.x - test[1].rightBottom.x) / 2 + test[1].rightBottom.x,\n        y: window.innerHeight - 150,\n        dx: 4,\n        dy: 4\n      },\n      hitBox: {\n        hx: 25,\n        hy: 25\n      },\n      vie: 3,\n      force: 10\n    },\n    pos: new Array(2).fill(1).map(_ => ({\n      life: conf.BALLLIFE,\n      coord: {\n        x: randomInt(width - (120 + 2 * conf.BOUNDLEFT)) + (60 + conf.BOUNDLEFT),\n        y: randomInt(height - (120 + 2 * conf.BOUNDTOP)) + (60 + conf.BOUNDTOP),\n        dx: 4 * randomSign(),\n        dy: 4 * randomSign()\n      }\n    })),\n    limite: test,\n    objectC: listObjectC,\n    objectR: listObjectR,\n    tirsEnnemie: new Array(0),\n    shootCooldownEnnemie: 0,\n    size: {\n      height: height - conf.BOUNDTOP,\n      width: width - conf.BOUNDLEFT\n    },\n    endOfGame: false,\n    tirs: tirs,\n    shootCooldownHero: 0,\n    ennemyDelay: 0,\n    debris: debris,\n    ennemisQuiTire: ennemisQuiTire\n  };\n  const ref = useRef();\n  const state = useRef(initialState);\n  const iterate = ctx => {\n    state.current = step(state.current);\n    render(ctx)(state.current);\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx));\n  };\n  const onClick = e => {\n    state.current = click(state.current)(e);\n  };\n  const onMove = e => {\n    state.current = mouseMove(state.current)(e);\n  };\n  const onKey = e => {\n    state.current = handleKeyPress(state.current)(e);\n  };\n  useEffect(() => {\n    if (ref.current) {\n      initCanvas(iterate)(ref.current);\n      ref.current.addEventListener('click', onClick);\n      ref.current.addEventListener('mousemove', onMove);\n      window.addEventListener(\"keydown\", onKey);\n    }\n    return () => {\n      ref.current.removeEventListener('click', onMove);\n      ref.current.removeEventListener('mousemove', onMove);\n      window.removeEventListener(\"keydown\", onKey);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    height,\n    width,\n    ref\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 10\n  }, this);\n};\n_s(Canvas, \"Gpm0P4FfDB25XYapIJctmdb7SaA=\");\n_c = Canvas;\nexport default Canvas;\nvar _c;\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"names":["conf","useRef","useEffect","step","click","mouseMove","handleKeyPress","render","jsxDEV","_jsxDEV","randomInt","max","Math","floor","random","randomSign","sign","initCanvas","iterate","canvas","ctx","getContext","requestAnimationFrame","Canvas","height","width","_s","test","Array","push","leftTop","x","y","rightBottom","BOUNDTOP","RADIUS","BOUNDLEFT","tirs","debris","ennemisQuiTire","listObjectC","coord","dx","dy","radius","listObjectR","initialState","hero","window","innerHeight","hitBox","hx","hy","vie","force","pos","fill","map","_","life","BALLLIFE","limite","objectC","objectR","tirsEnnemie","shootCooldownEnnemie","size","endOfGame","shootCooldownHero","ennemyDelay","ref","state","current","onClick","e","onMove","onKey","addEventListener","removeEventListener","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/varlesse/Documents/GitHub/try/ProjetCPAWEB/web/src/components/canvas/index.tsx"],"sourcesContent":["import * as conf from './conf'\r\nimport { useRef, useEffect } from 'react'\r\nimport { State, step, click, mouseMove, endOfGame, handleKeyPress } from './state'\r\nimport { render } from './renderer'\r\n\r\nconst randomInt = (max: number) => Math.floor(Math.random() * max)\r\nconst randomSign = () => Math.sign(Math.random() - 0.5)\r\n\r\nconst initCanvas =\r\n  (iterate: (ctx: CanvasRenderingContext2D) => void) =>\r\n  (canvas: HTMLCanvasElement) => {\r\n    const ctx = canvas.getContext('2d')\r\n    if (!ctx) return\r\n    requestAnimationFrame(() => iterate(ctx))\r\n  }\r\n\r\nconst Canvas = ({ height, width }: { height: number; width: number }) => {\r\n\r\n  const test = new Array(0) \r\n  test.push({leftTop:{x:0,y:0}, rightBottom:{x:width,y:conf.BOUNDTOP-(conf.RADIUS*2)}}) // Mur du haut\r\n  test.push({leftTop:{x:0,y:0}, rightBottom:{x:conf.BOUNDLEFT-(conf.RADIUS*2),y:height}}) // Mur de gauche\r\n  test.push({leftTop:{x:width-(conf.BOUNDLEFT),y:0}, rightBottom:{x:width,y:height}}) // Mur de droite\r\n  test.push({leftTop:{x:0,y:height-conf.BOUNDTOP}, rightBottom:{x:width,y:height}}) // Mur du bas\r\n\r\n  const tirs = new Array(0)\r\n  const debris = new Array(0)\r\n  const ennemisQuiTire = new Array(0)\r\n  const listObjectC = new Array(0)\r\n  listObjectC.push({coord:{x:500, y:350, dx:0, dy:0}, radius : 25})\r\n \r\n  const listObjectR = new Array(0)\r\n  listObjectR.push({leftTop:{x:1000, y:400}, rightBottom : {x:1100, y:500}})\r\n\r\n  const initialState: State = {\r\n    hero : {\r\n      coord : {\r\n        x: ((test[2].leftTop.x - test[1].rightBottom.x) /2)+ test[1].rightBottom.x,\r\n        y: window.innerHeight - 150,\r\n        dx: 4,\r\n        dy: 4,\r\n      },\r\n      hitBox : {\r\n        hx: 25, \r\n        hy: 25,\r\n      },\r\n      vie: 3,\r\n      force: 10,\r\n    },\r\n    pos: new Array(2).fill(1).map((_) => ({\r\n      life: conf.BALLLIFE,\r\n      coord: {\r\n        x: randomInt(width - (120+(2*conf.BOUNDLEFT))) + (60+conf.BOUNDLEFT),\r\n        y: randomInt(height - (120+(2*conf.BOUNDTOP))) + (60+conf.BOUNDTOP),\r\n        dx: 4 * randomSign(),\r\n        dy: 4 * randomSign(),\r\n      },\r\n    })),\r\n    limite: test,\r\n    objectC: listObjectC,\r\n    objectR: listObjectR,\r\n    tirsEnnemie: new Array(0),\r\n    shootCooldownEnnemie: 0,\r\n    \r\n    size: { height: height - conf.BOUNDTOP, width: width - conf.BOUNDLEFT  },\r\n    endOfGame: false,\r\n    tirs: tirs,\r\n    shootCooldownHero : 0,\r\n    ennemyDelay : 0,\r\n    debris : debris,\r\n    ennemisQuiTire : ennemisQuiTire\r\n  }\r\n\r\n  const ref = useRef<any>()\r\n  const state = useRef<State>(initialState)\r\n\r\n  const iterate = (ctx: CanvasRenderingContext2D) => {\r\n    state.current = step(state.current)\r\n    render(ctx)(state.current)\r\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx))\r\n  } \r\n\r\n  const onClick = (e: PointerEvent) => {\r\n    state.current = click(state.current)(e)\r\n  }\r\n\r\n  const onMove = (e: PointerEvent) => {\r\n    state.current = mouseMove(state.current)(e)\r\n  }\r\n\r\n  const onKey = (e: KeyboardEvent) => {\r\n    state.current = handleKeyPress(state.current)(e)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      initCanvas(iterate)(ref.current)\r\n      ref.current.addEventListener('click', onClick)\r\n      ref.current.addEventListener('mousemove', onMove)\r\n      window.addEventListener(\"keydown\",onKey)\r\n    }\r\n    return () => {\r\n      ref.current.removeEventListener('click', onMove)\r\n      ref.current.removeEventListener('mousemove', onMove)\r\n      window.removeEventListener(\"keydown\",onKey)\r\n    }\r\n  }, [])\r\n  return <canvas {...{ height, width, ref }} />\r\n}\r\n\r\nexport default Canvas\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}