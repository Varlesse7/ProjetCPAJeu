{"ast":null,"code":"var _jsxFileName = \"/home/ronald/Documents/STL-S2/CPA/ProjetCPAJeu/web/src/components/canvas/index.tsx\",\n  _s = $RefreshSig$();\nimport * as conf from './conf';\nimport { useRef, useEffect } from 'react';\nimport { step, mouseMove, handleKeyPress } from './state';\nimport { render } from './renderer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst randomInt = max => Math.floor(Math.random() * max);\nconst randomSign = () => Math.sign(Math.random() - 0.5);\nconst initCanvas = iterate => canvas => {\n  const ctx = canvas.getContext('2d');\n  if (!ctx) return;\n  requestAnimationFrame(() => iterate(ctx));\n};\nconst Canvas = ({\n  height,\n  width\n}) => {\n  _s();\n  const test = new Array(0);\n  test.push({\n    leftTop: {\n      x: 0,\n      y: 0\n    },\n    rightBottom: {\n      x: width,\n      y: conf.BOUNDTOP - conf.RADIUS * 2\n    }\n  }); // Mur du haut\n  test.push({\n    leftTop: {\n      x: 0,\n      y: 0\n    },\n    rightBottom: {\n      x: conf.BOUNDLEFT - conf.RADIUS * 2,\n      y: height\n    }\n  }); // Mur de gauche\n  test.push({\n    leftTop: {\n      x: width - conf.BOUNDLEFT,\n      y: 0\n    },\n    rightBottom: {\n      x: width,\n      y: height\n    }\n  }); // Mur de droite\n  test.push({\n    leftTop: {\n      x: 0,\n      y: height - conf.BOUNDTOP\n    },\n    rightBottom: {\n      x: width,\n      y: height\n    }\n  }); // Mur du bas\n\n  const tirs = new Array(0);\n  const debris = new Array(0);\n  const ennemisQuiTire = new Array();\n  const initialState = {\n    hero: {\n      coord: {\n        x: (test[2].leftTop.x - test[1].rightBottom.x) / 2 + test[1].rightBottom.x,\n        y: window.innerHeight - 150,\n        dx: 4,\n        dy: 4\n      },\n      hitBox: {\n        hx: 25,\n        hy: 25\n      },\n      vie: 3,\n      force: 10\n    },\n    limite: test,\n    tirsEnnemie: new Array(0),\n    size: {\n      height: height - conf.BOUNDTOP,\n      width: width - conf.BOUNDLEFT\n    },\n    endOfGame: false,\n    tirs: tirs,\n    shootCooldownHero: 0,\n    ennemyDelay: 0,\n    debris: debris,\n    ennemisQuiTire: ennemisQuiTire\n  };\n  const ref = useRef();\n  const state = useRef(initialState);\n  const iterate = ctx => {\n    state.current = step(state.current);\n    render(ctx)(state.current);\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx));\n  };\n\n  /*const onClick = (e: PointerEvent) => {\n    state.current = click(state.current)(e)\n  }*/\n\n  const onMove = e => {\n    state.current = mouseMove(state.current)(e);\n  };\n  const onKey = e => {\n    state.current = handleKeyPress(state.current)(e);\n  };\n  useEffect(() => {\n    if (ref.current) {\n      initCanvas(iterate)(ref.current);\n      //ref.current.addEventListener('click', onClick)\n      ref.current.addEventListener('mousemove', onMove);\n      window.addEventListener(\"keydown\", onKey);\n    }\n    return () => {\n      ref.current.removeEventListener('click', onMove);\n      ref.current.removeEventListener('mousemove', onMove);\n      window.removeEventListener(\"keydown\", onKey);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    height,\n    width,\n    ref\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 10\n  }, this);\n};\n_s(Canvas, \"Gpm0P4FfDB25XYapIJctmdb7SaA=\");\n_c = Canvas;\nexport default Canvas;\nvar _c;\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"names":["conf","useRef","useEffect","step","mouseMove","handleKeyPress","render","jsxDEV","_jsxDEV","randomInt","max","Math","floor","random","randomSign","sign","initCanvas","iterate","canvas","ctx","getContext","requestAnimationFrame","Canvas","height","width","_s","test","Array","push","leftTop","x","y","rightBottom","BOUNDTOP","RADIUS","BOUNDLEFT","tirs","debris","ennemisQuiTire","initialState","hero","coord","window","innerHeight","dx","dy","hitBox","hx","hy","vie","force","limite","tirsEnnemie","size","endOfGame","shootCooldownHero","ennemyDelay","ref","state","current","onMove","e","onKey","addEventListener","removeEventListener","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/ronald/Documents/STL-S2/CPA/ProjetCPAJeu/web/src/components/canvas/index.tsx"],"sourcesContent":["import * as conf from './conf'\nimport { useRef, useEffect } from 'react'\nimport { State, step, mouseMove, endOfGame, handleKeyPress, Rectangle } from './state'\nimport { render } from './renderer'\n\nconst randomInt = (max: number) => Math.floor(Math.random() * max)\nconst randomSign = () => Math.sign(Math.random() - 0.5)\n\nconst initCanvas =\n  (iterate: (ctx: CanvasRenderingContext2D) => void) =>\n  (canvas: HTMLCanvasElement) => {\n    const ctx = canvas.getContext('2d')\n    if (!ctx) return\n    requestAnimationFrame(() => iterate(ctx))\n  }\n\nconst Canvas = ({ height, width }: { height: number; width: number }) => {\n\n  const test = new Array(0) \n  test.push({leftTop:{x:0,y:0}, rightBottom:{x:width,y:conf.BOUNDTOP-(conf.RADIUS*2)}}) // Mur du haut\n  test.push({leftTop:{x:0,y:0}, rightBottom:{x:conf.BOUNDLEFT-(conf.RADIUS*2),y:height}}) // Mur de gauche\n  test.push({leftTop:{x:width-(conf.BOUNDLEFT),y:0}, rightBottom:{x:width,y:height}}) // Mur de droite\n  test.push({leftTop:{x:0,y:height-conf.BOUNDTOP}, rightBottom:{x:width,y:height}}) // Mur du bas\n\n  const tirs = new Array(0)\n  const debris = new Array(0)\n  const ennemisQuiTire = new Array<[number, Rectangle]>()\n\n  const initialState: State = {\n    hero : {\n      coord : {\n        x: ((test[2].leftTop.x - test[1].rightBottom.x) /2)+ test[1].rightBottom.x,\n        y: window.innerHeight - 150,\n        dx: 4,\n        dy: 4,\n      },\n      hitBox : {\n        hx: 25, \n        hy: 25,\n      },\n      vie: 3,\n      force: 10,\n    },\n    limite: test,\n    tirsEnnemie: new Array(0),\n    \n    size: { height: height - conf.BOUNDTOP, width: width - conf.BOUNDLEFT  },\n    endOfGame: false,\n    tirs: tirs,\n    shootCooldownHero : 0,\n    ennemyDelay : 0,\n    debris : debris,\n    ennemisQuiTire : ennemisQuiTire\n  }\n\n  const ref = useRef<any>()\n  const state = useRef<State>(initialState)\n\n  const iterate = (ctx: CanvasRenderingContext2D) => {\n    state.current = step(state.current)\n    render(ctx)(state.current)\n    if (!state.current.endOfGame) requestAnimationFrame(() => iterate(ctx))\n  } \n\n  /*const onClick = (e: PointerEvent) => {\n    state.current = click(state.current)(e)\n  }*/\n\n  const onMove = (e: PointerEvent) => {\n    state.current = mouseMove(state.current)(e)\n  }\n\n  const onKey = (e: KeyboardEvent) => {\n    state.current = handleKeyPress(state.current)(e)\n  }\n\n  useEffect(() => {\n    if (ref.current) {\n      initCanvas(iterate)(ref.current)\n      //ref.current.addEventListener('click', onClick)\n      ref.current.addEventListener('mousemove', onMove)\n      window.addEventListener(\"keydown\",onKey)\n    }\n    return () => {\n      ref.current.removeEventListener('click', onMove)\n      ref.current.removeEventListener('mousemove', onMove)\n      window.removeEventListener(\"keydown\",onKey)\n    }\n  }, [])\n  return <canvas {...{ height, width, ref }} />\n}\n\nexport default Canvas\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}